<!DOCTYPE html>
<html  lang="de-De">

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Praxis der Datenanalyse</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Eine Einführung in moderne Statistik für Praktiker">
  <meta name="generator" content="bookdown 0.2.3 and GitBook 2.6.7">

  <meta property="og:title" content="Praxis der Datenanalyse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.jpg" />
  <meta property="og:description" content="Eine Einführung in moderne Statistik für Praktiker" />
  <meta name="github-repo" content="sebastiansauer/Praxis_der_Datenanalyse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Praxis der Datenanalyse" />
  
  <meta name="twitter:description" content="Eine Einführung in moderne Statistik für Praktiker" />
  <meta name="twitter:image" content="cover.jpg" />

<meta name="author" content="Sebastian Sauer, Matthias Gehrke, Karsten Lübke, Oliver Gansser">


<meta name="date" content="2017-04-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="distanzmae-mit-r-berechnen.html">
<link rel="next" href="ubung-b3-datensatz.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

true

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Praxis der Datenanalyse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="k-means-clusteranalyse" class="section level2">
<h2><span class="header-section-number">14.6</span> k-Means Clusteranalyse</h2>
<p>Beim k-Means Clusterverfahren handelt es sich um eine bestimmte Form von Clusteranalysen; zahlreiche Alternativen existieren, aber die k-Means Clusteranalyse ist recht verbreitet. Im Gegensatz zur z.B. der hierarchischen Clusteranalyse um ein partitionierendes Verfahren. Die Daten werde in k Cluster aufgeteilt – dabei muss die Anzahl der Cluster im vorhinein feststehen. Ziel ist es, dass die Quadratsumme der Abweichungen der Beobachtungen im Cluster zum Clusterzentrum minimiert wird.</p>
<p>Der Ablauf des Verfahrens ist wie folgt:</p>
<ol style="list-style-type: decimal">
<li>Zufällige Beobachtungen als Clusterzentrum</li>
<li>Zuordnung der Beobachtungen zum nächsten Clusterzentrum (Ähnlichkeit, z. B. über die euklidische Distanz)</li>
<li>Neuberechnung der Clusterzentren als Mittelwert der dem Cluster zugeordneten Beobachtungen</li>
</ol>
<p>Dabei werden die Schritte 2. und 3. solange wiederholt, bis sich keine Änderung der Zuordnung mehr ergibt – oder eine maximale Anzahl an Iterationen erreicht wurde.</p>
<p><em>Hinweis:</em> Die (robuste) Funktion <code>pam()</code> aus dem Paket <code>cluster</code> kann auch mit allgemeinen Distanzen umgehen. Außerdem für gemischte Variablentypen gut geeignet: Das Paket <a href="https://cran.r-project.org/web/packages/clustMixType/index.html"><code>clustMixType</code></a>.</p>
<p>Zur Vorbereitung überführen wir die nominalen Merkmale in logische, d. h. binäre Merkmale, und löschen die Segmente sowie das Ergebnis der hierarchischen Clusteranalyse:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segment.num &lt;-<span class="st"> </span>segment %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Frau =</span> Geschlecht ==<span class="st"> &quot;Frau&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Eigenheim =</span> Eigenheim ==<span class="st">&quot;Ja&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Mitgliedschaft =</span> Mitgliedschaft ==<span class="st"> &quot;Ja&quot;</span>) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(-Geschlecht, -Segment)</code></pre></div>
<p>Über die Funktion <code>mutate()</code> werden Variablen im Datensatz erzeugt oder verändert. Über <code>select()</code> werden einzene Variablen ausgewählt. Die “Pfeife” <code>%&gt;%</code> übergeben das Ergebnis der vorherigen Funktion an die folgende.</p>
<p>Aufgrund von (1.) hängt das Ergebnis einer k-Means Clusteranalyse vom Zufall ab. Aus Gründen der Reproduzierbarkeit sollte daher der Zufallszahlengenerator gesetzt werden. Außerdem bietet es sich an verschiedene Startkonfigurationen zu versuchen. in der Funktion <code>kmeans()</code> erfolgt dies durch die Option <code>nstart=</code>. Hier mit <code>k=4</code> Clustern:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1896</span>)

seg.k &lt;-<span class="st"> </span><span class="kw">kmeans</span>(segment.num, <span class="dt">centers =</span> <span class="dv">4</span>, <span class="dt">nstart =</span> <span class="dv">10</span>)
seg.k
<span class="co">#&gt; K-means clustering with 4 clusters of sizes 111, 26, 58, 105</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster means:</span>
<span class="co">#&gt;   Alter Einkommen Kinder Eigenheim Mitgliedschaft  Frau</span>
<span class="co">#&gt; 1  42.9     46049  1.649     0.505         0.1081 0.568</span>
<span class="co">#&gt; 2  56.4     85973  0.385     0.538         0.0385 0.538</span>
<span class="co">#&gt; 3  27.0     22608  1.224     0.276         0.2069 0.414</span>
<span class="co">#&gt; 4  43.6     62600  1.505     0.457         0.1238 0.590</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Clustering vector:</span>
<span class="co">#&gt;   [1] 1 4 4 1 4 4 4 1 2 4 1 1 4 4 1 1 1 1 1 4 4 4 1 4 1 1 1 1 4 1 4 4 1 1 2</span>
<span class="co">#&gt;  [36] 1 4 1 1 4 4 4 1 4 4 4 4 1 1 1 1 1 2 1 1 4 4 4 4 1 4 1 4 1 1 1 1 4 4 4</span>
<span class="co">#&gt;  [71] 4 1 1 4 1 1 4 4 4 4 1 4 1 3 1 4 1 1 1 1 4 4 4 1 1 4 1 4 4 4 3 3 3 3 3</span>
<span class="co">#&gt; [106] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="co">#&gt; [141] 3 3 3 3 3 3 3 3 3 3 1 2 4 2 2 4 1 1 2 2 4 4 1 1 4 2 4 4 1 2 2 3 4 1 2</span>
<span class="co">#&gt; [176] 2 4 2 3 4 4 4 1 1 1 1 1 1 4 3 1 4 4 4 4 1 1 1 2 4 4 1 2 4 4 1 4 2 1 2</span>
<span class="co">#&gt; [211] 4 3 4 2 2 4 2 1 4 3 1 2 2 4 2 4 4 1 4 4 1 1 1 1 1 3 1 1 4 1 4 3 1 4 1</span>
<span class="co">#&gt; [246] 4 1 4 1 4 4 4 4 1 1 1 4 4 1 1 1 1 1 1 4 1 1 1 1 1 2 4 4 1 4 1 1 1 1 2</span>
<span class="co">#&gt; [281] 4 4 4 4 1 4 1 4 4 4 1 4 1 4 1 4 1 1 4 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Within cluster sum of squares by cluster:</span>
<span class="co">#&gt; [1] 3.18e+09 2.22e+09 1.69e+09 2.81e+09</span>
<span class="co">#&gt;  (between_SS / total_SS =  90.6 %)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Available components:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    </span>
<span class="co">#&gt; [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        </span>
<span class="co">#&gt; [9] &quot;ifault&quot;</span></code></pre></div>
<p>Neben der Anzahl Beobachtungen im Cluster (z. B. 26 in Cluster 2) werden auch die Clusterzentren ausgegeben. Diese können dann direkt verglichen werden. Sie sehen z. B., dass das Durchschnittsalter in Cluster 3 mit 27 am geringsten ist. Der Anteil der Eigenheimbesitzer ist mit 54 % in Cluster 2 am höchsten.</p>
<p>Einen Plot der Scores auf den beiden ersten Hauptkomponenten können Sie über die Funktion <code>clusplot()</code> aus dem Paket <code>cluster</code> erhalten.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">clusplot</span>(segment.num, seg.k$cluster, 
         <span class="dt">color =</span> <span class="ot">TRUE</span>, <span class="dt">shade =</span> <span class="ot">TRUE</span>, <span class="dt">labels =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="082_Clusteranalyse_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /> Wie schon im deskriptiven Ergebnis: Die Cluster <code>1</code> und <code>4</code> unterscheiden sich (in den ersten beiden Hauptkomponenten) nicht wirklich. Vielleicht sollten dies noch zusammengefasst werden, d. h., mit <code>centers=3</code> die Analyse wiederholt werden?<a href="#fn63" class="footnoteRef" id="fnref63"><sup>63</sup></a></p>
<hr />
</div>
<div class="footnotes">
<hr />
<ol start="63">
<li id="fn63"><p>Das Paket <code>NbClust</code>, siehe Malika Charrad, Nadia Ghazzali, Veronique Boiteau, Azam Niknafs (2014) <em>NbClust: An R Package for Determining the Relevant Number of Clusters in a Data Set</em>, Journal of Statistical Software, 61(6), 1-36. <a href="http://dx.doi.org/10.18637/jss.v061.i06" class="uri">http://dx.doi.org/10.18637/jss.v061.i06</a>, bietet viele Möglichkeiten die Anzahl der Cluster optimal zu bestimmen.<a href="k-means-clusteranalyse.html#fnref63">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distanzmae-mit-r-berechnen.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ubung-b3-datensatz.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
